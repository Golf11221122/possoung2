<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏≤‡∏´‡∏≤‡∏£</title>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    body {
      font-family: 'Prompt', sans-serif;
      background: linear-gradient(135deg, #ffb347, #0052cc);
      color: #002b5b;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
    }
    button {
      font-family: 'Prompt', sans-serif;
      font-weight: 600;
      border: none;
      background: #fff;
      color: #002b5b;
      padding: 10px 20px;
      border-radius: 15px;
      cursor: pointer;
      box-shadow: 0 3px 6px rgba(0,0,0,0.2);
    }
    button:hover {
      background: #f5f5f5;
    }
    h1 {
      font-size: 1.8em;
      margin-bottom: 15px;
    }
    #menu-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 15px;
      padding: 10px 20px 100px 20px;
    }
    .menu-item {
      background: rgba(255,255,255,0.8);
      border-radius: 20px;
      padding: 10px;
      transition: transform 0.2s;
    }
    .menu-item:hover { transform: scale(1.03); }
    .menu-item img {
      width: 100%;
      border-radius: 15px;
    }
    .menu-item h3 {
      margin: 10px 0 5px;
      font-size: 1.1em;
    }
    .menu-item p {
      margin: 0;
      color: #004080;
    }
    .cart-btn {
      position: fixed;
      bottom: 25px;
      right: 25px;
      background: #004080;
      border-radius: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px 15px;
      color: white;
      font-weight: bold;
      font-size: 1.1em;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    .cart-btn img {
      width: 24px;
      margin-right: 5px;
    }
  </style>
</head>
<body>
  <header>
    <button onclick="goHome()">‚Üê Home</button>
    <h1>‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h1>
    <button onclick="goBack()">‚Üê Back</button>
  </header>

  <div id="menu-container">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏°‡∏ô‡∏π...</div>

  <div class="cart-btn" onclick="openCart()">
    <img src="https://cdn-icons-png.flaticon.com/512/1170/1170678.png" alt="cart">
    <span id="cart-count">0</span>
  </div>

  <audio id="clickSound" src="click.mp3" preload="auto"></audio>

  <script>
    const clickSound = document.getElementById('clickSound');
    const { createClient } = supabase;
    const supabaseUrl = "https://pujxykbpxsncbrlquaxo.supabase.co";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB1anh5a2JweHNuY2JybHF1YXhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3OTI0OTIsImV4cCI6MjA3ODM2ODQ5Mn0.JxavkquEZo0W7NME4CJ01GbLKR0_gYFdcKy2BWCrAso";
    const supabaseClient = createClient(supabaseUrl, supabaseKey);

    function goHome() {
      clickSound.play();
      window.location.href = "index.html";
    }

    function goBack() {
      clickSound.play();
      window.history.back();
    }

    function openCart() {
      clickSound.play();
      alert("‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤ üòÑ");
    }

    async function loadMenu() {
      const menuContainer = document.getElementById("menu-container");
      menuContainer.innerHTML = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏°‡∏ô‡∏π...";

      const { data: menuData, error } = await supabaseClient
        .from("menu")
        .select("*")
        .eq("available", true)
        .order("id", { ascending: true });

      if (error) {
        console.error(error);
        menuContainer.innerHTML = "‚ùå ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏°‡∏ô‡∏π‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
        return;
      }

      if (!menuData || menuData.length === 0) {
        menuContainer.innerHTML = "<p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏°‡∏ô‡∏π</p>";
        return;
      }

      menuContainer.innerHTML = "";
      menuData.forEach(item => {
        const card = document.createElement("div");
        card.className = "menu-item";
        card.innerHTML = `
          <img src="${item.image || 'https://via.placeholder.com/150'}" alt="${item.name}">
          <h3>${item.name}</h3>
          <p>${item.price} ‡∏ö‡∏≤‡∏ó</p>
        `;
        menuContainer.appendChild(card);
      });
    }

    loadMenu();
  </script>
</body>
</html>