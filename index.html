<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JOKJUNG POS - Login</title>
  <style>
    body { margin: 0; padding: 20px; font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to bottom right, #FFA500, #FFF);
      color: #002366; text-align: center; }
    #storeName { font-size: 3em; font-weight: bold; margin-bottom: 20px; }
    #pinDisplay { font-size: 2em; letter-spacing: 10px; margin-bottom: 20px; min-height: 40px; }
    .button-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; max-width: 300px; margin: auto; }
    .btn { padding: 20px; font-size: 1.5em; border: none; border-radius: 20px;
      background: #ffffffcc; color: #002366; box-shadow: 0 4px 6px rgba(0,0,0,0.2);
      cursor: pointer; transition: 0.3s; }
    .btn:hover { background: #fff; transform: scale(1.05); }
  </style>
</head>
<body>
  <h1>Welcome Happy Today</h1>
  <div id="storeName">JOKJUNG</div>
  <div id="pinDisplay"></div>
  <div class="button-grid">
    <button class="btn" onclick="appendNumber('1')">1</button>
    <button class="btn" onclick="appendNumber('2')">2</button>
    <button class="btn" onclick="appendNumber('3')">3</button>
    <button class="btn" onclick="appendNumber('4')">4</button>
    <button class="btn" onclick="appendNumber('5')">5</button>
    <button class="btn" onclick="appendNumber('6')">6</button>
    <button class="btn" onclick="appendNumber('7')">7</button>
    <button class="btn" onclick="appendNumber('8')">8</button>
    <button class="btn" onclick="appendNumber('9')">9</button>
    <button class="btn" onclick="clearPin()">X</button>
    <button class="btn" onclick="appendNumber('0')">0</button>
    <button class="btn" onclick="login()">LOG IN</button>
  </div>

  <script>
    let pin = "";
    function appendNumber(num) {
      if (pin.length < 6) {
        pin += num;
        document.getElementById("pinDisplay").innerText = "*".repeat(pin.length);
      }
    }
    function clearPin() { pin = ""; document.getElementById("pinDisplay").innerText = ""; }

    async function login() {
      if (pin.length !== 6) { alert("กรุณากรอกรหัส 6 หลัก"); return; }

      // ⚙️ ใส่ลิงก์ Apps Script ของคุณตรงนี้
      const scriptUrl = "https://script.google.com/macros/s/AKfycbzY9gDX-lBW8lg9nAS5XJ40beHLLMki9UcPe9QyLPlir7Zl1v1bAzgxzyWCIBFBSDNm/exec";

      try {
        const res = await fetch(scriptUrl, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ pin: pin })
        });
        const result = await res.text();
        console.log("Server Response:", result);

        if (result.includes("OK")) window.location.href = "./menu.html?pin=" + pin;
        else if (result.includes("NO")) { alert("รหัสไม่ถูกต้อง กรุณาลองใหม่"); clearPin(); }
        else alert("คำตอบจากเซิร์ฟเวอร์: " + result);
      } catch (err) {
        console.error("Fetch error:", err);
        alert("เกิดข้อผิดพลาดในการเชื่อมต่อ: " + err.message);
      }
    }
  </script>
</body>
</html>
